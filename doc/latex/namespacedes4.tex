\hypertarget{namespacedes4}{}\section{des4 Namespace Reference}
\label{namespacedes4}\index{des4@{des4}}


Contains functions related to the simplified D\+ES defined in our book.  


\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespacedes4_1_1__internal}{\+\_\+internal}
\begin{DoxyCompactList}\small\item\em Internal functions of the simplified D\+ES, these are not intended for use by a user. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \hyperlink{namespacedes4_a6c685705f99e1a32a7867c233aae061f}{encrypt} (uint16\+\_\+t block, uint16\+\_\+t key, const uint64\+\_\+t \&rounds=4)
\begin{DoxyCompactList}\small\item\em Encrypts a block using a specific number of rounds of the simplified D\+ES. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{namespacedes4_a63b8ec1214e2e4d8898b51452d9244d6}{decrypt} (uint16\+\_\+t block, uint16\+\_\+t key, const uint64\+\_\+t \&rounds=4)
\begin{DoxyCompactList}\small\item\em Decrypts a block using a specific number of rounds of the simplified D\+ES. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{namespacedes4_a74228bee8ad5bfd25aa9ee71a2925b96}{crack3} (std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$ des3)
\begin{DoxyCompactList}\small\item\em Cracks a 3-\/round simplified D\+ES using differential cryptanalysis. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{namespacedes4_a86feaa54b71fc0499b6b173be65be458}{crack4} (std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$ des4, uint64\+\_\+t iterations=250)
\begin{DoxyCompactList}\small\item\em Cracks a 4-\/round simplified D\+ES using differential cryptanalysis and a probabalistic weaknesses in the S-\/\+Boxes. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Contains functions related to the simplified D\+ES defined in our book. 

The simplified D\+ES uses 12-\/bit blocks instead of 64-\/bit, and has a 9-\/bit key. There are only two S-\/\+Boxes, and they transform 4-\/bit numbers to 3-\/bit numbers. Additionally, there is no initial and final permutaion. 

\subsection{Function Documentation}
\index{des4@{des4}!crack3@{crack3}}
\index{crack3@{crack3}!des4@{des4}}
\subsubsection[{\texorpdfstring{crack3(std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$ des3)}{crack3(std::function< uint16_t(uint16_t)> des3)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t des4\+::crack3 (
\begin{DoxyParamCaption}
\item[{std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$}]{des3}
\end{DoxyParamCaption}
)}\hypertarget{namespacedes4_a74228bee8ad5bfd25aa9ee71a2925b96}{}\label{namespacedes4_a74228bee8ad5bfd25aa9ee71a2925b96}


Cracks a 3-\/round simplified D\+ES using differential cryptanalysis. 

Using the analyze3 function of the \hyperlink{namespacedes4_1_1__internal}{des4\+::\+\_\+internal} namespace, we can obtain the key for a 3 round simplified D\+ES by trying multiple inputs and seeing what they encrypt to.

Since the analyze3 function returns multiple possibilities for the left and right halves of the final key, it is run multiple times with different inputs until only 1 possible left and right half remain.

Since this still leaves 1 bit of the full 9-\/bit key unknown, the key is tested with both 0 and 1 for that unknown bit to see which encrypts to the correct value.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em des3} & A function which encrypts using 3 rounds of the simplified D\+ES and some unknown key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint16\+\_\+t -\/ The 9-\/bit key that the encryption function is using 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em logic\+\_\+error} & \+: No options are left for the left or right half of the key \\
\hline
{\em logic\+\_\+error} & \+: Neither version of the 9-\/bit key encrypts to the expected value \\
\hline
\end{DoxyExceptions}
\index{des4@{des4}!crack4@{crack4}}
\index{crack4@{crack4}!des4@{des4}}
\subsubsection[{\texorpdfstring{crack4(std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$ des4, uint64\+\_\+t iterations=250)}{crack4(std::function< uint16_t(uint16_t)> des4, uint64_t iterations=250)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t des4\+::crack4 (
\begin{DoxyParamCaption}
\item[{std\+::function$<$ uint16\+\_\+t(uint16\+\_\+t)$>$}]{des4, }
\item[{uint64\+\_\+t}]{iterations}
\end{DoxyParamCaption}
)}\hypertarget{namespacedes4_a86feaa54b71fc0499b6b173be65be458}{}\label{namespacedes4_a86feaa54b71fc0499b6b173be65be458}


Cracks a 4-\/round simplified D\+ES using differential cryptanalysis and a probabalistic weaknesses in the S-\/\+Boxes. 

An analysis of the S-\/\+Boxes of the simplified D\+ES shows that not all outputs are equally likely.
\begin{DoxyItemize}
\item For Box 1, if two 4-\/bit values X\+OR to 0011 there is a 3/4 chance that the X\+OR of their outputs is 011
\item For Box 2, if two 4-\/bit values X\+OR to 1100 there is a 1/2 chance that the X\+OR of their outputs is 010
\end{DoxyItemize}

Therefore, if the S-\/\+Boxes are independent, there is a 3/8 chance that, for any given $ R_i, R_i^* $ which X\+OR to 00111100, the output of the outputs of $ F(R_i), F(R_i^*) $ will X\+OR to 011010. (They\textquotesingle{}re not actually independent, some of the bits of $ R_i $ get used in both because of how the expansion function works, but it\textquotesingle{}s close enough)

Using this, we can pick some $L_0, L_0^*$ such that $L_0 \mathbin{\oplus} L_0^* = L_0' = 011010$. Since $ L_0 $ is X\+O\+Red with the output of the F function, we now have a 3/8 chance that $ R_1' = 000000 $. If this is the case it also follows that $ R_1 = R_1^* $

So, using the above insights, we can say that, if we pick $ R_0, R_0^* $ such that $ R_0' = 001100$ and some $ L_0, L_0^*$ such that $ L_0' = 011010 $, there is a 3/8 chance that $ L_1'R_1' = 001100000000$.

At this point, if we know the output after four rounds of the simplified D\+ES, we can use the 3 round differential analysis to get potential key halfs for $ k_4 $. If the input values $ L_0R_0, L_0^*R_0^*$ are randomly chosen, then 3/8 of the time, the assumption that $ L_1'R_1' = 001100000000$ will be correct, and the actual key halves will be returned. The rest of the time, incorrect keys will be returned; but there is no particular reason that any particular wrong key part should be more likely than another. Therefore, if this process is done Many Times $^{TM}$, the most commonly returned key halves are likely the correct halves of $ k_f $. The final bit of the original key can be found by trying both 0 and 1


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \hyperlink{namespacedes4}{des4}} & A function which encrypts using 3 rounds of the simplified D\+ES and some unknown key \\
\hline
\mbox{\tt in}  & {\em iterations} & The number of times to repeat the above process to get potential key halves \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint16\+\_\+t -\/ The 9-\/bit key that the encryption function is using 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em logic\+\_\+error} & \+: Neither version of the 9-\/bit key encrypts to the expected value \\
\hline
\end{DoxyExceptions}
\index{des4@{des4}!decrypt@{decrypt}}
\index{decrypt@{decrypt}!des4@{des4}}
\subsubsection[{\texorpdfstring{decrypt(uint16\+\_\+t block, uint16\+\_\+t key, const uint64\+\_\+t \&rounds=4)}{decrypt(uint16_t block, uint16_t key, const uint64_t &rounds=4)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t des4\+::decrypt (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{block, }
\item[{uint16\+\_\+t}]{key, }
\item[{const uint64\+\_\+t \&}]{rounds}
\end{DoxyParamCaption}
)}\hypertarget{namespacedes4_a63b8ec1214e2e4d8898b51452d9244d6}{}\label{namespacedes4_a63b8ec1214e2e4d8898b51452d9244d6}


Decrypts a block using a specific number of rounds of the simplified D\+ES. 

Since the prev\+\_\+key function does the rotate before returning $ k_i $, the key inputted to this function is first rotated to key $ k_{n+1} $. The simplified D\+ES round function is run the specified number of times, and the result is returned


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em block} & The 12-\/bit block to decrypt \\
\hline
\mbox{\tt in}  & {\em key} & The 9-\/bit key to use \\
\hline
\mbox{\tt in}  & {\em rounds} & The number of rounds to do \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint16\+\_\+t -\/ The decrypted 12-\/bit block 
\end{DoxyReturn}
\index{des4@{des4}!encrypt@{encrypt}}
\index{encrypt@{encrypt}!des4@{des4}}
\subsubsection[{\texorpdfstring{encrypt(uint16\+\_\+t block, uint16\+\_\+t key, const uint64\+\_\+t \&rounds=4)}{encrypt(uint16_t block, uint16_t key, const uint64_t &rounds=4)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t des4\+::encrypt (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{block, }
\item[{uint16\+\_\+t}]{key, }
\item[{const uint64\+\_\+t \&}]{rounds}
\end{DoxyParamCaption}
)}\hypertarget{namespacedes4_a6c685705f99e1a32a7867c233aae061f}{}\label{namespacedes4_a6c685705f99e1a32a7867c233aae061f}


Encrypts a block using a specific number of rounds of the simplified D\+ES. 

Since the next\+\_\+key function does the rotate before returning $ k_i $, the key inputted to this function is first rotated to key $ k_{-1} $. The simplified D\+ES round function is run the specified number of times, and the result is returned


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em block} & The 12-\/bit block to encrypt \\
\hline
\mbox{\tt in}  & {\em key} & The 9-\/bit key to use \\
\hline
\mbox{\tt in}  & {\em rounds} & The number of rounds to do \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint16\+\_\+t -\/ The encrypted 12-\/bit block 
\end{DoxyReturn}
