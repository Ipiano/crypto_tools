\hypertarget{namespacecryptomath_1_1primality}{}\section{cryptomath\+:\+:primality Namespace Reference}
\label{namespacecryptomath_1_1primality}\index{cryptomath\+::primality@{cryptomath\+::primality}}


Contains specific primality tests.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class Integral $>$ }\\bool \hyperlink{namespacecryptomath_1_1primality_ae03b6e47f6d34221e644f6ebdb0fb13a}{miller\+Rabin} (const Integral \&n, const uint64\+\_\+t \&iterations=10)
\begin{DoxyCompactList}\small\item\em Implementation of Miller-\/\+Rabin primality test. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Integral $>$ }\\bool \hyperlink{namespacecryptomath_1_1primality_a533dcc14534b531442954ee32afb2b56}{solovay\+Strassen} (const Integral \&n, const uint64\+\_\+t \&iterations=10)
\begin{DoxyCompactList}\small\item\em Implementation of the Solovay-\/\+Strassen primality test. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Contains specific primality tests. 

\subsection{Function Documentation}
\index{cryptomath\+::primality@{cryptomath\+::primality}!miller\+Rabin@{miller\+Rabin}}
\index{miller\+Rabin@{miller\+Rabin}!cryptomath\+::primality@{cryptomath\+::primality}}
\subsubsection[{\texorpdfstring{miller\+Rabin(const Integral \&n, const uint64\+\_\+t \&iterations=10)}{millerRabin(const Integral &n, const uint64_t &iterations=10)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class Integral $>$ bool cryptomath\+::primality\+::miller\+Rabin (
\begin{DoxyParamCaption}
\item[{const Integral \&}]{n, }
\item[{const uint64\+\_\+t \&}]{iterations = {\ttfamily 10}}
\end{DoxyParamCaption}
)}\hypertarget{namespacecryptomath_1_1primality_ae03b6e47f6d34221e644f6ebdb0fb13a}{}\label{namespacecryptomath_1_1primality_ae03b6e47f6d34221e644f6ebdb0fb13a}


Implementation of Miller-\/\+Rabin primality test. 

Given a number $ n $, we can determine if it is prime by looking at all $ a^{d}, a^{2^rd} $ mod $ n $ for some $ a $ and $ r < s-1 $ where $ d, s $ are found by factoring $ n-1 $ into $ 2^sd$. By Fermat\textquotesingle{}s Little theorem, either $ a^{d} = 1$ or $ a^{2^rd} = -1$.

The Miller Rabin test uses the contrapositive of this statement. If some $ r $ can be found such that $ a^{d} \neq 1$ or $ a^{2^rd} \neq -1$, we know $ n $ is not prime. If no such $ r $ can be found, then $ a $ is a witness of $ n $ being prime. However, 1/4 of all integers in $ Z_n $ will be a witness even if $ n $ is not prime, so multiple values should be tested.

The chance this test returns a false positive is (1/4)$^\wedge$iterations

Template arguments
\begin{DoxyItemize}
\item class Integral -\/ Some integer type
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & -\/ The number to test for primality \\
\hline
\mbox{\tt in}  & {\em iterations} & -\/ The number of witness values to test (Default 10) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool -\/ Whether or not $ n $ is probably prime 
\end{DoxyReturn}
\index{cryptomath\+::primality@{cryptomath\+::primality}!solovay\+Strassen@{solovay\+Strassen}}
\index{solovay\+Strassen@{solovay\+Strassen}!cryptomath\+::primality@{cryptomath\+::primality}}
\subsubsection[{\texorpdfstring{solovay\+Strassen(const Integral \&n, const uint64\+\_\+t \&iterations=10)}{solovayStrassen(const Integral &n, const uint64_t &iterations=10)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class Integral $>$ bool cryptomath\+::primality\+::solovay\+Strassen (
\begin{DoxyParamCaption}
\item[{const Integral \&}]{n, }
\item[{const uint64\+\_\+t \&}]{iterations = {\ttfamily 10}}
\end{DoxyParamCaption}
)}\hypertarget{namespacecryptomath_1_1primality_a533dcc14534b531442954ee32afb2b56}{}\label{namespacecryptomath_1_1primality_a533dcc14534b531442954ee32afb2b56}


Implementation of the Solovay-\/\+Strassen primality test. 

Euler\textquotesingle{}s legendre symbol can be calculated as $ (\frac{a}{p}) = a^{(p-1)/2} $ for all $ p $ prime. The Jacobi symbol $ (\frac{a}{n}) $ is a generalization to all odd integers. One method of defining the Jacobi is in terms of the legendre of all prime factors of $ n $; however, it can also be computed by the Law of Quadratic Reciprocity.

So, if some $ n $ is prime, then it stands to reason that the Jacobi should equal the Legendre $ (\frac{a}{n}) = a^{(p-1)/2} $ for all $ a $.

Unfortunately, it is not enough to test this for just one $ a $. There is a 1/2 chance that it will be true for any $ a $ in $ Z_n $. So, by testing multiple random $ a $, we can determine that $ n $ is very likely to be prime.

The chance this test returns a false positive is (1/2)$^\wedge$iterations

Template arguments
\begin{DoxyItemize}
\item class Integral -\/ Some integer type
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & -\/ The number to test for primality \\
\hline
\mbox{\tt in}  & {\em iterations} & -\/ The number of witness values to test (Default 10) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool -\/ Whether or not $ n $ is probably prime 
\end{DoxyReturn}
