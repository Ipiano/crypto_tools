<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Crypto Module: bbs::blum_blum_shub_engine&lt; Result, Integral, bits, prime_reps &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Crypto Module
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacebbs.html">bbs</a></li><li class="navelem"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html">blum_blum_shub_engine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classbbs_1_1blum__blum__shub__engine-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">bbs::blum_blum_shub_engine&lt; Result, Integral, bits, prime_reps &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A random engine implementing the Blum Blum Shub pseudorandom generator algorithm which satisfies the C++ UniformRandomBitGenerator concept The Blum Blum Shub pseudorandom generation algorithm is as follows</p><ol type="1">
<li>Pick two primes \( p, q \) such that \( p \) and \( q \) are congruent to 3 mod 4</li>
<li>Define \( n = p * q \)</li>
<li>Pick a seed \( x \) such that \( x \) is coprime to \( n \)</li>
<li>\( x_0 = x^2\) (mod \( n \))</li>
<li>Repeatedly yield \( x_n \) where \( x_n = x_n^2 \) (mod \( n \)) </li>
</ol>
 
 <a href="classbbs_1_1blum__blum__shub__engine.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:af8f60205a8a8b5cee055ed54d5739805"><td class="memItemLeft" align="right" valign="top">typedef Result&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a></td></tr>
<tr class="separator:af8f60205a8a8b5cee055ed54d5739805"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6560d8c40e0f42f72adce96fdf2cba34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#a6560d8c40e0f42f72adce96fdf2cba34">blum_blum_shub_engine</a> (Integral p, Integral q, Integral x=-1)</td></tr>
<tr class="separator:a6560d8c40e0f42f72adce96fdf2cba34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78164c5ee3e7c0d1b2e8070029e33ec7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#a78164c5ee3e7c0d1b2e8070029e33ec7">operator()</a> ()</td></tr>
<tr class="separator:a78164c5ee3e7c0d1b2e8070029e33ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4c76e93e841646e0f57919b7e6d759f4"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#a4c76e93e841646e0f57919b7e6d759f4">min</a> ()</td></tr>
<tr class="separator:a4c76e93e841646e0f57919b7e6d759f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab150bc100f30d32a7b64ca0834eaa0d9"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#ab150bc100f30d32a7b64ca0834eaa0d9">max</a> ()</td></tr>
<tr class="separator:ab150bc100f30d32a7b64ca0834eaa0d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class Result = uint32_t, class Integral = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt;<br />
class bbs::blum_blum_shub_engine&lt; Result, Integral, bits, prime_reps &gt;</h3>

<p>A random engine implementing the Blum Blum Shub pseudorandom generator algorithm which satisfies the C++ UniformRandomBitGenerator concept The Blum Blum Shub pseudorandom generation algorithm is as follows</p><ol type="1">
<li>Pick two primes \( p, q \) such that \( p \) and \( q \) are congruent to 3 mod 4</li>
<li>Define \( n = p * q \)</li>
<li>Pick a seed \( x \) such that \( x \) is coprime to \( n \)</li>
<li>\( x_0 = x^2\) (mod \( n \))</li>
<li>Repeatedly yield \( x_n \) where \( x_n = x_n^2 \) (mod \( n \)) </li>
</ol>
<p>This algorithm makes use of quadratic-residue to generate random bit sequences. Since \( x \) is coprime to \( n \), we can fairly confident that successive powers of \( x \) will yield a sequence of numbers which will not repeat for a very long time. By repeatedly doing \( x^2 \), we turn this into a one-way function because square roots mod \( n \) are difficult to compute. Furthermore, since only the last bits of each number are returned, we can be confident that, even if the most significant portion of the number gets repeated, the bits outputted will be pseudo-random.</p>
<p>Notes</p><ul>
<li>To maximize the cycle length of the generator, it is recommended that \( gcd(\phi(p), \phi(q)) \) be small</li>
<li>The maximum number of bits that can be safely returned from each \( x_n \) is \( log_2(log_2(n)) \)</li>
</ul>
<p>This generator also satisfies the C++ concept UniformRandomBitGenerator, which means it can be used in conjunction with any of the C++ random distributions to yield a sequence of random numbers that from that distribution.</p>
<p>Template arguments</p><ul>
<li>class Result - Unsigned result type to return yielded bits in</li>
<li>class Integral - Type to use for internal computation</li>
<li>uint64_t bits - Number of least significant bits of each \( x_n \) to return (default 1)</li>
<li>uint32_t prime_reps - Number of repetitions to use in Miller-Rabin prime test function (default 25) </li>
</ul>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="af8f60205a8a8b5cee055ed54d5739805"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result  = uint32_t, class Integral  = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef Result <a class="el" href="classbbs_1_1blum__blum__shub__engine.html">bbs::blum_blum_shub_engine</a>&lt; Result, Integral, bits, prime_reps &gt;::<a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Typedef of return type to satisfy UniformRandomBitGenerator </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6560d8c40e0f42f72adce96fdf2cba34"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result  = uint32_t, class Integral  = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html">bbs::blum_blum_shub_engine</a>&lt; Result, Integral, bits, prime_reps &gt;::<a class="el" href="classbbs_1_1blum__blum__shub__engine.html">blum_blum_shub_engine</a> </td>
          <td>(</td>
          <td class="paramtype">Integral&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integral&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integral&#160;</td>
          <td class="paramname"><em>x</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs a new random generator with \( p, q \) and optional seed \( x \)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The first prime to use to find \( n \) </td></tr>
    <tr><td class="paramname">q</td><td>The second prime to use to find \( n \) </td></tr>
    <tr><td class="paramname">x</td><td>Optional initial seed. If not specified, the valid number greater than \( p \) which is a prime plus 1 is used</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">domain_error</td><td>: \( p \) or \( q \) is not prime </td></tr>
    <tr><td class="paramname">domain_error</td><td>: \( p \) or \( q \) is not congruent to 3 mod 4 </td></tr>
    <tr><td class="paramname">domain_error</td><td>: The generator cannot securely yield the templated number of bits given \( p \) and \( q \) </td></tr>
    <tr><td class="paramname">domain_error</td><td>: \( x \) is specified and it is not relatively prime to \( n \) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab150bc100f30d32a7b64ca0834eaa0d9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result  = uint32_t, class Integral  = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static constexpr <a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a> <a class="el" href="classbbs_1_1blum__blum__shub__engine.html">bbs::blum_blum_shub_engine</a>&lt; Result, Integral, bits, prime_reps &gt;::max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns maximum possible value output by the generator</p>
<p>Needed to satisy UniformRandomBitGenerator</p>
<dl class="section return"><dt>Returns</dt><dd>The largest value that can be contained by the templated Result </dd></dl>

</div>
</div>
<a class="anchor" id="a4c76e93e841646e0f57919b7e6d759f4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result  = uint32_t, class Integral  = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static constexpr <a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a> <a class="el" href="classbbs_1_1blum__blum__shub__engine.html">bbs::blum_blum_shub_engine</a>&lt; Result, Integral, bits, prime_reps &gt;::min </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns minimum possible value output by the generator</p>
<p>Needed to satisy UniformRandomBitGenerator</p>
<dl class="section return"><dt>Returns</dt><dd>The smallest value that can be contained by the templated Result </dd></dl>

</div>
</div>
<a class="anchor" id="a78164c5ee3e7c0d1b2e8070029e33ec7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result  = uint32_t, class Integral  = uint64_t, uint64_t bits = 1, uint64_t prime_reps = 25&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbbs_1_1blum__blum__shub__engine.html#af8f60205a8a8b5cee055ed54d5739805">result_type</a> <a class="el" href="classbbs_1_1blum__blum__shub__engine.html">bbs::blum_blum_shub_engine</a>&lt; Result, Integral, bits, prime_reps &gt;::operator() </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the next \( x_n \) and yields the template-defined number of bits</p>
<dl class="section return"><dt>Returns</dt><dd>Result - The least significant bits of \( x_n \) </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>modules/module_crypto/librandom/bbs/headers/<a class="el" href="bbs_8h_source.html">bbs.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 11 2017 17:22:28 for Crypto Module by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
